"use strict";function SaldosTotalesPorcResp_PageInit(){document.body.style.cursor="default",document.documentElement.style.cursor="default",MostrarGarantiasFiduciariasRelacionadas(!0),MostrarGarantiasRealesRelacionadas(!0),MostrarGarantiasValoresRelacionadas(!0),$("#accordionGF").accordion(),$("#accordionGR").accordion(),$("#accordionGV").accordion(),$datosConsulta="",$arregloOperaciones="",$queryString=new Array,$cuentaMensajes=0,$porcentajeCien=!1,AsignarCambioManual(!1),AsignarSumatoriaValida(!0),HabilitarRegionBusqueda(-1),ValidarPermisoEdicion(),$$("txtContabilidad").on("keydown",function(a){var e,o=new Array("c","x","v"),t=a.keyCode?a.keyCode:a.which;if(e=a.ctrlKey){for(i=0;i<o.length;i++)if(o[i]==String.fromCharCode(t).toLowerCase())return!0}else 8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105||a.preventDefault()}),$$("txtOficina").on("keydown",function(a){var e,o=new Array("c","x","v"),t=a.keyCode?a.keyCode:a.which;if(e=a.ctrlKey){for(i=0;i<o.length;i++)if(o[i]==String.fromCharCode(t).toLowerCase())return!0}else 8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105||a.preventDefault()}),$$("txtMoneda").on("keydown",function(a){var e,o=new Array("c","x","v"),t=a.keyCode?a.keyCode:a.which;if(e=a.ctrlKey){for(i=0;i<o.length;i++)if(o[i]==String.fromCharCode(t).toLowerCase())return!0}else 8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105||a.preventDefault()}),$$("txtProducto").on("keydown",function(a){var e,o=new Array("c","x","v"),t=a.keyCode?a.keyCode:a.which;if(e=a.ctrlKey){for(i=0;i<o.length;i++)if(o[i]==String.fromCharCode(t).toLowerCase())return!0}else 8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105||a.preventDefault()}),$$("txtOperacion").on("keydown",function(a){var e,o=new Array("c","x","v"),t=a.keyCode?a.keyCode:a.which;if(e=a.ctrlKey){for(i=0;i<o.length;i++)if(o[i]==String.fromCharCode(t).toLowerCase())return!0}else 8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105||a.preventDefault()}),$$("txtCedulaFiador").on("keydown",function(a){var e,o=new Array("c","x","v"),t=a.keyCode?a.keyCode:a.which;if(e=a.ctrlKey){for(i=0;i<o.length;i++)if(o[i]==String.fromCharCode(t).toLowerCase())return!0}else 8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105||a.preventDefault()}),$$("txtPartido").on("keydown",function(a){var e=parseInt($$("cbTipoGarantiaReal").val());3!=e&&($(this).val().length+1<=1?8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.keyCode>=49&&a.keyCode<=55||a.keyCode>=97&&a.keyCode<=103||a.preventDefault():8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.preventDefault())}),$$("txtNumFinca").on("keydown",function(a){var e,o=parseInt($$("cbClaseGarantiaReal").val()),t=new Array("c","x","v"),r=a.keyCode?a.keyCode:a.which;if(e=a.ctrlKey,o>=10&&29>=o&&11!=o)if($(this).val().length+1<=6)if(e){for(i=0;i<t.length;i++)if(t[i]==String.fromCharCode(r).toLowerCase())return!0}else 8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105||a.preventDefault();else if($.isNumeric(String.fromCharCode(a.which)))a.preventDefault();else if(e){for(i=0;i<t.length;i++)if(t[i]==String.fromCharCode(r).toLowerCase())return!0}else 8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.preventDefault();else if(o>=30&&69>=o&&38!=o&&43!=o)if(e){for(i=0;i<t.length;i++)if(t[i]==String.fromCharCode(r).toLowerCase())return!0}else 8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105||a.preventDefault()}),$$("txtGrado").on("keydown",function(a){8==a.keyCode||9==a.keyCode||46==a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.keyCode>=48&&a.keyCode<=57||a.keyCode>=96&&a.keyCode<=105||a.preventDefault()}),$MensajePorcentajeMaximo=$('<div class="ui-widget" style="padding-top:2.2em;"><div class="ui-state-error ui-corner-all" style="padding: 0 .7em;"><p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span>Debido al valor ingresado sólo está operación o contrato mostrará un porcentaje de responsabilidad y monto mitigador.</p></div></div>').dialog({autoOpen:!1,title:"Porcentaje Responsabilidad",resizable:!1,draggable:!1,height:235,width:650,closeOnEscape:!1,open:function(a,e){$(".ui-dialog-titlebar-close").hide(),$(this).dialog("widget").position({my:"center bottom",at:"center bottom",of:window,collision:"none"})},modal:!0,buttons:{Aceptar:function(){$(this).dialog("close"),AsignarPorcentajeMinimo()},Cancelar:function(){$(this).dialog("close"),$$("txtPorcentajeResponsabilidad").focus()}}})}function MostrarGarantiasFiduciariasRelacionadas(a){var e=parseInt(null!=$$("hdnIndiceAccordionGFActivo").val()?$$("hdnIndiceAccordionGFActivo").val():"-1"),o=parseInt(null!=$$("hdnHabilitarGF").val()?$$("hdnHabilitarGF").val():"0");-1===e&&(e=!1),1===o&&(a||(a=!0)),$("#accordionGF").accordion({icons:{header:"ui-icon-circle-arrow-e",activeHeader:"ui-icon-circle-arrow-s"},collapsible:!0,active:e,header:"h3",activate:function(a,e){var o=$(this).accordion("option","active");0===o?$$("hdnIndiceAccordionGFActivo").val("0"):$$("hdnIndiceAccordionGFActivo").val("-1")},beforeActivate:function(e,i){0==a&&0===o&&e.preventDefault()},create:function(o,i){a||0===e?$(this).accordion("enable"):($(this).accordion("disable"),$(this).accordion("option","disabled",!0))}})}function MostrarGarantiasRealesRelacionadas(a){var e=parseInt(null!=$$("hdnIndiceAccordionGRActivo").val()?$$("hdnIndiceAccordionGRActivo").val():"-1"),o=parseInt(null!=$$("hdnHabilitarGR").val()?$$("hdnHabilitarGR").val():"0");-1===e&&(e=!1),1===o&&(a||(a=!0)),$("#accordionGR").accordion({icons:{header:"ui-icon-circle-arrow-e",activeHeader:"ui-icon-circle-arrow-s"},collapsible:!0,active:e,header:"h3",activate:function(a,e){var o=$(this).accordion("option","active");0===o?$$("hdnIndiceAccordionGRActivo").val("0"):$$("hdnIndiceAccordionGRActivo").val("-1")},beforeActivate:function(e,i){0==a&&0===o&&e.preventDefault()},create:function(o,i){a||0===e?$(this).accordion("enable"):($(this).accordion("disable"),$(this).accordion("option","disabled",!0))}})}function MostrarGarantiasValoresRelacionadas(a){var e=parseInt(null!=$$("hdnIndiceAccordionGVActivo").val()?$$("hdnIndiceAccordionGVActivo").val():"-1"),o=parseInt(null!=$$("hdnHabilitarGV").val()?$$("hdnHabilitarGV").val():"0");-1===e&&(e=!1),1===o&&(a||(a=!0)),$("#accordionGV").accordion({icons:{header:"ui-icon-circle-arrow-e",activeHeader:"ui-icon-circle-arrow-s"},collapsible:!0,active:e,header:"h3",activate:function(a,e){var o=$(this).accordion("option","active");0===o?$$("hdnIndiceAccordionGVActivo").val("0"):$$("hdnIndiceAccordionGVActivo").val("-1")},beforeActivate:function(e,i){0==a&&0===o&&e.preventDefault()},create:function(o,i){a||0===e?$(this).accordion("enable"):($(this).accordion("disable"),$(this).accordion("option","disabled",!0))}})}function HabilitarGF(a){a?$("#accordionGF").accordion("enable"):($("#accordionGF").accordion("disable"),$("#accordionGF").accordion("option","disabled",!0))}function HabilitarGR(a){a?$("#accordionGR").accordion("enable"):($("#accordionGR").accordion("disable"),$("#accordionGR").accordion("option","disabled",!0))}function HabilitarGV(a){a?$("#accordionGV").accordion("enable"):($("#accordionGV").accordion("disable"),$("#accordionGV").accordion("option","disabled",!0))}function ContraerGFR(){$$("hdnIndiceAccordionGFActivo").val("-1")}function ContraerGRR(){$$("hdnIndiceAccordionGRActivo").val("-1")}function ContraerGVR(){$$("hdnIndiceAccordionGVActivo").val("-1")}function HabilitarRegionBusqueda(a){switch($$("filaBusquedaGarantiaFiduciaria").hide(),$$("filaTipoGarantiaReal").hide(),$$("filaBusquedaGarantiaReal").hide(),$$("filaClaseGarantiaReal").hide(),$$("filaGradoCedula").hide(),$$("filaBusquedaGarantiaValor").hide(),$$("accordionGF").hide(),$$("accordionGR").hide(),$$("accordionGV").hide(),$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide(),a){case 1:$$("filaBusquedaOperacion").show(),$$("filaTipoGarantiaReal").hide(),$$("filaClaseGarantiaReal").hide(),$$("filaBusquedaGarantia").hide(),$$("lblTipoOperacion").text("Operación:");break;case 2:$$("filaBusquedaOperacion").show(),$$("filaTipoGarantiaReal").hide(),$$("filaClaseGarantiaReal").hide(),$$("filaBusquedaGarantia").hide(),$$("lblTipoOperacion").text("Contrato:");break;case 3:$$("filaBusquedaGarantia").show(),$$("filaTipoGarantiaReal").hide(),$$("filaClaseGarantiaReal").hide(),$$("filaBusquedaOperacion").hide()}}function LimpiarCamposBusqueda(){$$("txtContabilidad").val("1"),$$("txtOficina").val(""),$$("txtMoneda").val(""),$$("txtProducto").val(""),$$("txtOperacion").val(""),$$("cbTipoPersona").val("-1"),$$("txtCedulaFiador").val(""),$$("cbClaseGarantiaReal").val("-1"),$$("txtPartido").val(""),$$("txtNumFinca").val(""),$$("txtGrado").val(""),$$("txtCedulaHipotecaria").val(""),$$("cbClaseGarantiaValor").val("-1"),$$("txtNumeroSeguridad").val("")}function HabilitarCamposBusqueda(){var a=parseInt(null!=$$("cbTipoBusqueda").val()?$$("cbTipoBusqueda").val():"1");switch($$("lblMensaje").text(""),$$("tablaGarantiasFiduciarias").empty(),$$("tablaGarantiasReales").empty(),$$("tablaGarantiasValor").empty(),("undefined"==typeof $queryString||"undefined"!=typeof $queryString&&0==$queryString.length)&&(LimpiarCamposBusqueda(),$$("filaRetorno").hide()),a){case 1:HabilitarRegionBusqueda(1),$$("columnaProducto").show();break;case 2:HabilitarRegionBusqueda(2),$$("columnaProducto").hide();break;case 3:HabilitarRegionBusqueda(3);var e=parseInt(null!=$$("hdnCatalogoGarantias").val()?$$("hdnCatalogoGarantias").val():"-1");CargarListaCatalogo(e,$$("cbTipoGarantia"),"-1","-1");break;default:HabilitarRegionBusqueda(1),$$("columnaProducto").show()}}function HabilitarCamposBusquedaGarantia(){var a=parseInt(null!=$$("cbTipoGarantia").val()?$$("cbTipoGarantia").val():"-1"),e="-1";switch(("undefined"==typeof $queryString||"undefined"!=typeof $queryString&&0==$queryString.length)&&(LimpiarCamposBusqueda(),$$("filaRetorno").hide()),a){case 1:$$("filaBusquedaGarantiaFiduciaria").show(),$$("filaTipoGarantiaReal").hide(),$$("filaBusquedaGarantiaReal").hide(),$$("filaClaseGarantiaReal").hide(),$$("filaGradoCedula").hide(),$$("filaBusquedaGarantiaValor").hide(),e=parseInt(null!=$$("hdnCatalogoTiposPersona").val()?$$("hdnCatalogoTiposPersona").val():"-1"),CargarListaCatalogo(e,$$("cbTipoPersona"),"-1","-1");break;case 2:$$("filaTipoGarantiaReal").show(),$$("filaBusquedaGarantiaFiduciaria").hide(),$$("filaBusquedaGarantiaReal").hide(),$$("filaClaseGarantiaReal").hide(),$$("filaGradoCedula").hide(),$$("filaBusquedaGarantiaValor").hide(),e=parseInt(null!=$$("hdnCatalogoTiposGarantiaReal").val()?$$("hdnCatalogoTiposGarantiaReal").val():"-1"),CargarListaCatalogo(e,$$("cbTipoGarantiaReal"),"-1","-1");break;case 3:$$("filaBusquedaGarantiaValor").show(),$$("filaBusquedaGarantiaFiduciaria").hide(),$$("filaTipoGarantiaReal").hide(),$$("filaClaseGarantiaReal").hide(),$$("filaGradoCedula").hide(),$$("filaBusquedaGarantiaReal").hide(),e=parseInt(null!=$$("hdnCatalogoClasesGarantia").val()?$$("hdnCatalogoClasesGarantia").val():"-1"),CargarListaCatalogo(e,$$("cbClaseGarantiaValor"),"3","-1");break;default:$$("filaBusquedaGarantiaFiduciaria").hide(),$$("filaTipoGarantiaReal").hide(),$$("filaClaseGarantiaReal").hide(),$$("filaBusquedaGarantiaReal").hide(),$$("filaGradoCedula").hide(),$$("filaBusquedaGarantiaValor").hide()}}function HabilitarCamposBusquedaGarantiaReal(){var a=parseInt(null!=$$("cbTipoGarantiaReal").val()?$$("cbTipoGarantiaReal").val():"1"),e="-1";switch(("undefined"==typeof $queryString||"undefined"!=typeof $queryString&&0==$queryString.length)&&(LimpiarCamposBusqueda(),$$("filaRetorno").hide()),e=parseInt(null!=$$("hdnCatalogoClasesGarantia").val()?$$("hdnCatalogoClasesGarantia").val():"-1"),CargarListaCatalogo(e,$$("cbClaseGarantiaReal"),"2",a),$$("filaTipoGarantiaReal").show(),$$("filaBusquedaGarantiaReal").show(),$$("filaClaseGarantiaReal").show(),$$("filaBusquedaGarantiaFiduciaria").hide(),$$("filaBusquedaGarantiaValor").hide(),a){case 1:$$("filaGradoCedula").hide(),$$("lblPartido").text("Partido:");break;case 2:$$("filaGradoCedula").show(),$$("filaGradoCedula").css("display","inline"),$$("lblPartido").text("Partido:");break;case 3:$$("filaGradoCedula").hide(),$$("lblPartido").text("Clase Bien:");break;default:$$("lblPartido").text("Partido:"),$$("filaGradoCedula").hide()}}function ValidarCamposOpercion(){var a=parseInt(null!=$$("cbTipoBusqueda").val()?$$("cbTipoBusqueda").val():"-1");return 0===$$("txtContabilidad").val().length?($$("lblMensaje").text("Debe ingresar el código de contabilidad"),!1):0===$$("txtOficina").val().length?($$("lblMensaje").text("Debe ingresar el código de oficina"),!1):0===$$("txtMoneda").val().length?($$("lblMensaje").text("Debe ingresar el código de moneda"),!1):1===a&&0===$$("txtProducto").val().length?($$("lblMensaje").text("Debe ingresar el código del producto"),!1):0===$$("txtOperacion").val().length?(1===a?$$("lblMensaje").text("Debe ingresar el número de operación"):$$("lblMensaje").text("Debe ingresar el número de contrato"),!1):!0}function ValidarCamposGarantia(){var a=parseInt(null!=$$("cbTipoGarantia").val()?$$("cbTipoGarantia").val():"-1");return 1!==a||0!==$$("cbTipoPersona").val().length&&"-1"!=$$("cbTipoPersona").val()?1===a&&0===$$("txtCedulaFiador").val().length?($$("lblMensaje").text("Debe ingresar la identificación del fiador"),!1):2!==a||0!==$$("cbTipoGarantiaReal").val().length&&"-1"!=$$("cbTipoGarantiaReal").val()?2!==a||0!==$$("cbClaseGarantiaReal").val().length&&"-1"!=$$("cbClaseGarantiaReal").val()?2===a&&"3"!=$$("cbTipoGarantiaReal").val()&&0===$$("txtPartido").val().length?($$("lblMensaje").text("Debe ingresar el código del partido"),!1):2===a&&"3"!=$$("cbTipoGarantiaReal").val()&&0===$$("txtNumFinca").val().length?($$("lblMensaje").text("Debe ingresar el Id Garantía"),!1):2===a&&"3"==$$("cbTipoGarantiaReal").val()&&0===$$("txtNumFinca").val().length?($$("lblMensaje").text("Debe ingresar el Id Garantía"),!1):2===a&&"2"==$$("cbTipoGarantiaReal").val()&&0===$$("txtGrado").val().length?($$("lblMensaje").text("Debe ingresar el código de grado"),!1):3!==a||0!==$$("cbClaseGarantiaValor").val().length&&"-1"!=$$("cbClaseGarantiaValor").val()?3===a&&0===$$("txtNumeroSeguridad").val().length?($$("lblMensaje").text("Debe ingresar el número de seguridad"),!1):!0:($$("lblMensaje").text("Debe seleccionar la clase de garantía"),!1):($$("lblMensaje").text("Debe seleccionar la clase de garantía"),!1):($$("lblMensaje").text("Debe seleccionar el tipo de garantía real"),!1):($$("lblMensaje").text("Debe seleccionar el tipo de persona del fiador"),!1)}function CargarPaginaSTPR(cadenaJson){if(LimpiarCamposBusqueda(),$queryString=new Array,$$("filaRetorno").hide(),"undefined"!=typeof $queryString){if(0==$queryString.length&&"undefined"!=typeof cadenaJson&&cadenaJson.length>0){for(var params=eval("("+cadenaJson+")"),i=0;i<params.length;i++){var object=params[i];for(var property in object){var key=property,value=object[property];$queryString[key]=value}}null!=$queryString.tipogarantia&&"1"==$queryString.tipogarantia?($$("cbTipoBusqueda").val("3"),$$("cbTipoBusqueda").trigger("change"),$$("cbTipoGarantia").val("1"),$$("cbTipoGarantia").trigger("change"),null!=$queryString.tipofiador&&null!=$queryString.idfiador&&($$("cbTipoPersona").val($queryString.tipofiador),$$("txtCedulaFiador").val($queryString.idfiador),ValidarGarantia()),$$("filaRetorno").show()):null!=$queryString.tipogarantia&&"2"==$queryString.tipogarantia?($$("cbTipoBusqueda").val("3"),$$("cbTipoBusqueda").trigger("change"),$$("cbTipoGarantia").val("2"),$$("cbTipoGarantia").trigger("change"),null!=$queryString.tipogarantiareal&&null!=$queryString.clase&&null!=$queryString.partido&&null!=$queryString.idgarantia&&null!=$queryString.grado&&($$("cbTipoGarantiaReal").val($queryString.tipogarantiareal),$$("cbTipoGarantiaReal").trigger("change"),$$("cbClaseGarantiaReal").val($queryString.clase),$$("txtPartido").val($queryString.partido),$$("txtNumFinca").val($queryString.idgarantia),"2"==$queryString.tipogarantiareal&&$$("txtGrado").val($queryString.grado),ValidarGarantia()),$$("filaRetorno").show()):null!=$queryString.tipogarantia&&"3"==$queryString.tipogarantia?($$("cbTipoBusqueda").val("3"),$$("cbTipoBusqueda").trigger("change"),$$("cbTipoGarantia").val("3"),$$("cbTipoGarantia").trigger("change"),null!=$queryString.clase&&null!=$queryString.numseguridad&&($$("cbClaseGarantiaValor").val($queryString.clase),$$("txtNumeroSeguridad").val($queryString.numseguridad),ValidarGarantia()),$$("filaRetorno").show()):$$("filaRetorno").hide()}}else $$("cbTipoBusqueda").val("1"),$$("cbTipoBusqueda").trigger("change")}function formatFloat(a,e,o,i){0>a?(a=-a,sinal=-1):sinal=1;var t="",r="";if(a!=Math.floor(a)){for(r=Math.round((a-Math.floor(a))*Math.pow(10,e)).toString();r.length<e;)r="0"+r;e>0?(t=o+r,a=Math.floor(a)):a=Math.round(a)}for(;a>0;){if(r=(a-1e3*Math.floor(a/1e3)).toString(),a=Math.floor(a/1e3),a>0)for(;r.length<3;)r="0"+r;t=r+t,a>0&&(t=i+t)}return sinal<0&&(t="-"+t),t}function htmlDecode(a){return $("<div/>").html(a).text()}function InicializarClaseTablasGarantias(a){$("#tablaGarantiasFiduciarias table tr").each(function(){$(this).children("td").each(function(){$(this).attr("class","celdaNormal")})}),$("#tablaGarantiasReales table tr").each(function(){$(this).children("td").each(function(){$(this).attr("class","celdaNormal")})}),$("#tablaGarantiasValor table tr").each(function(){$(this).children("td").each(function(){$(this).attr("class","celdaNormal")})}),a.parent().is("td")&&a.parent().attr("class","celdaSeleccionada")}function DesplegarAjustes(a,e){var o=0;if($arregloOperaciones.length>0){$$("filaDetalleAjuste").show(),$PermisoEdicion=$$("hdnPermisoEdicion").val(),$$("lblMensaje").text("");for(var i=0;i<$arregloOperaciones.length;i++)if(o=i,1===$arregloOperaciones[i].NumeroRegistro&&$arregloOperaciones[i].ConsecutivoOperacion==a&&$arregloOperaciones[i].ConsecutivoGarantia==e){var t=$arregloOperaciones[i].SaldoActualAjustado>0?$arregloOperaciones[i].SaldoActualAjustado:$arregloOperaciones[i].SaldoActual>0?$arregloOperaciones[i].SaldoActual:"0.00",r=$arregloOperaciones[i].PorcentajeResponsabilidadAjustado>=0?$arregloOperaciones[i].PorcentajeResponsabilidadAjustado:"0.00";$RegistroExcluido=$arregloOperaciones[i].IndicadorExcluido,$registroSeleccionado=new RegistroSeleccionado(a,e,$arregloOperaciones[i].CodigoTipoGarantia,t,$arregloOperaciones[i].SaldoActual,r,o,t),$$("lblNumeroOperacion").text($arregloOperaciones[i].OperacionLarga),$$("txtSaldoAjustado").val(t),$$("txtPorcentajeResponsabilidad").val(r),$$("txtSaldoAjustado").trigger("change"),$$("txtPorcentajeResponsabilidad").trigger("change"),$arregloOperaciones[i].IndicadorExcluido?($$("btnInsertar").show(),$$("btnModificar").hide(),$$("btnEliminar").hide()):($$("btnModificar").show(),$$("btnEliminar").show(),$$("btnInsertar").hide())}$arregloOperaciones.length>1?($$("Siguiente").removeAttr("disabled"),$$("Anterior").removeAttr("disabled")):($$("Siguiente").attr("disabled","disabled"),$$("Anterior").attr("disabled","disabled"))}"0"===$PermisoEdicion?($$("txtSaldoAjustado").attr("disabled","disabled"),$$("txtPorcentajeResponsabilidad").attr("disabled","disabled"),$$("btnInsertar").hide(),$$("btnModificar").hide(),$$("btnEliminar").hide(),$$("btnLimpiar").hide()):($$("txtSaldoAjustado").removeAttr("disabled"),$$("txtPorcentajeResponsabilidad").removeAttr("disabled"),$RegistroExcluido?($$("btnInsertar").show(),$$("btnModificar").hide(),$$("btnEliminar").hide()):($$("btnModificar").show(),$$("btnEliminar").show(),$$("btnInsertar").hide()))}function LimpiarCampos(){$$("txtSaldoAjustado").val("0.00"),$$("txtPorcentajeResponsabilidad").val("0.00"),$$("lblMensaje").text(""),$RegistroExcluido?($$("btnInsertar").show(),$$("btnModificar").hide(),$$("btnEliminar").hide()):($$("btnModificar").show(),$$("btnEliminar").show(),$$("btnInsertar").hide())}function ObtenerRegistroValido(a,e){var o=-1;if(null!=$arregloOperaciones&&$arregloOperaciones.length>0)if(e){for(var i=a+1;i<$arregloOperaciones.length;i++)if(1===$arregloOperaciones[i].NumeroRegistro){o=i;break}}else for(var i=a-1;i>=0;i--)if(1===$arregloOperaciones[i].NumeroRegistro){o=i;break}return o}function RegistroSiguiente(){if($$("lblMensaje").text(""),$arregloOperaciones.length>0&&null!=$registroSeleccionado){var a=ObtenerRegistroValido($registroSeleccionado.IndiceRegistro,!0),e=$arregloOperaciones.length-1;a>=0?($CambioManual&&(ActualizaValoresAjustados(),ActualizarGrid()),a==e&&1===$arregloOperaciones[a].NumeroRegistro?(DesplegarAjustes($arregloOperaciones[a].ConsecutivoOperacion,$arregloOperaciones[a].ConsecutivoGarantia),$$("Siguiente").attr("disabled","disabled")):e>a&&1===$arregloOperaciones[a].NumeroRegistro?(DesplegarAjustes($arregloOperaciones[a].ConsecutivoOperacion,$arregloOperaciones[a].ConsecutivoGarantia),$$("Siguiente").removeAttr("disabled")):a>e&&$$("Siguiente").attr("disabled","disabled")):$$("Siguiente").attr("disabled","disabled")}}function RegistroAnterior(){if($$("lblMensaje").text(""),$arregloOperaciones.length>0&&null!=$registroSeleccionado){var a=ObtenerRegistroValido($registroSeleccionado.IndiceRegistro,!1);a>=0?($CambioManual&&(ActualizaValoresAjustados(),ActualizarGrid()),a>=0&&1===$arregloOperaciones[a].NumeroRegistro?(DesplegarAjustes($arregloOperaciones[a].ConsecutivoOperacion,$arregloOperaciones[a].ConsecutivoGarantia),$$("Anterior").removeAttr("disabled"),0===a&&(DesplegarAjustes($arregloOperaciones[a].ConsecutivoOperacion,$arregloOperaciones[a].ConsecutivoGarantia),$$("Anterior").attr("disabled","disabled"))):0>a&&$$("Anterior").attr("disabled","disabled")):$$("Anterior").attr("disabled","disabled")}else $$("Anterior").attr("disabled","disabled")}function ConvertirArregloOperacionesJson(){if($arregloOperaciones.length>0){var a="{",e=$arregloOperaciones.length;for(i=0;i<e;i++)a+='"Consecutivo_Operacion":"'+$arregloOperaciones[i].ConsecutivoOperacion+'",',a+='"Consecutivo_Garantia":"'+$arregloOperaciones[i].ConsecutivoGarantia+'",',a+='"Codigo_Tipo_Garantia":"'+$arregloOperaciones[i].CodigoTipoGarantia+'",',a+='"Codigo_Tipo_Operacion":"'+$arregloOperaciones[i].CodigoTipoOperacion+'",',a+='"Cuenta_Contable":"'+$arregloOperaciones[i].CuentaContable+'",',a+='"Saldo_Actual":"'+$arregloOperaciones[i].SaldoActual+'",',a+='"Saldo_Actual_Ajustado":"'+$arregloOperaciones[i].SaldoActualAjustado+'",',a+='"Porcentaje_Responsabilidad_Ajustado":"'+$arregloOperaciones[i].PorcentajeResponsabilidadAjustado+'",',a+='"Tipo_Operacion":"'+$arregloOperaciones[i].TipoOperacion+'",',a+='"Operacion_Larga":"'+$arregloOperaciones[i].OperacionLarga+'",',a+='"Indicador_Ajuste_Saldo_Actual":"'+($arregloOperaciones[i].IndicadorAjusteSaldoActual?"1":"0")+'",',a+='"Indicador_Ajuste_Porcentaje":"'+($arregloOperaciones[i].IndicadorAjustePorcentaje?"1":"0")+'",',a+='"Indicador_Excluido":"'+($arregloOperaciones[i].IndicadorExcluido?"1":"0")+'",',a+='"IndicadorCuentaContableEspecial":"'+($arregloOperaciones[i].IndicadorCuentaContableEspecial?"1":"0")+'",',a+='"IdentificacionGarantia":"'+$arregloOperaciones[i].IdentificacionGarantia+'",',a+='"Indicador_Ajuste_Campo_Saldo":"'+($arregloOperaciones[i].IndicadorAjusteCampoSaldo?"1":"0")+'",',a+='"Indicador_Ajuste_Campo_Porcentaje":"'+($arregloOperaciones[i].IndicadorAjusteCampoPorcentaje?"1":"0")+'",',a+='"Porcentaje_Responsabilidad_Calculado":"'+$arregloOperaciones[i].PorcentajeResponsabilidadCalculado+'",',a+='"Numero_Registro":"'+$arregloOperaciones[i].NumeroRegistro+'"',a+='"}',i!=e-1&&(a+=",");return a}}function AsignarPorcentajeMinimo(){if($arregloOperaciones.length>0&&null!=$registroSeleccionado)for(var a=0;a<$arregloOperaciones.length;a++)$arregloOperaciones[a].ConsecutivoOperacion!=$registroSeleccionado.ConsecutivoOperacion&&$arregloOperaciones[a].ConsecutivoGarantia!=$registroSeleccionado.ConsecutivoGarantia&&$arregloOperaciones[a].CodigoTipoGarantia!=$registroSeleccionado.CodigoTipoGarantia&&($arregloOperaciones[a].PorcentajeResponsabilidadAjustado=0,$arregloOperaciones[a].PorcentajeResponsabilidadCalculado=0),ActualizarGrid()}function ActualizarGrid(){if($arregloOperaciones.length>0){var a='<input type="checkbox" checked="checked" disabled="disabled"/>',e='<input type="checkbox"disabled="disabled"/>',o=$("[id*=gdvOperaciones] tr:last-child").clone(!0);$("[id*=gdvOperaciones] tr").not($("[id*=gdvOperaciones] tr:first-child")).remove();for(var i=0;i<$arregloOperaciones.length;i++)1===$arregloOperaciones[i].NumeroRegistro&&($("td",o).eq(0).html('<a style="color: #333333" href="javascript:DesplegarAjustes(\''+$arregloOperaciones[i].ConsecutivoOperacion+"', '"+$arregloOperaciones[i].ConsecutivoGarantia+"');\" onclick=\"javascript:DesplegarAjustes('"+$arregloOperaciones[i].ConsecutivoOperacion+"', '"+$arregloOperaciones[i].ConsecutivoGarantia+"');\">"+$arregloOperaciones[i].OperacionLarga+"</a>"),$("td",o).eq(1).html($arregloOperaciones[i].SaldoActualTexto),$("td",o).eq(2).html($arregloOperaciones[i].PorcentajeResponsabilidadTexto),$("td",o).eq(3).html(2!==$arregloOperaciones[i].CodigoTipoOperacion?$arregloOperaciones[i].CuentaContable:"-"),$("td",o).eq(4).html($arregloOperaciones[i].TipoOperacion),$("td",o).eq(5).html($arregloOperaciones[i].IndicadorExcluido?a:e),$("td",o).eq(6).html($arregloOperaciones[i].ConsecutivoOperacion),$("td",o).eq(7).html($arregloOperaciones[i].ConsecutivoGarantia),$("td",o).eq(8).html($arregloOperaciones[i].CodigoTipoGarantia),$("td",o).eq(9).html($arregloOperaciones[i].IndicadorExcluido),$("[id*=gdvOperaciones]").append(o),o=$("[id*=gdvOperaciones] tr:last-child").clone(!0));$$("gdvOperaciones").show()}}function ConfirmarInsertar(){var a=confirm("Está seguro que desea incluir el registro seleccionado?");return 1==a?(ValidarDatosAjustados(1),!0):!1}function ConfirmarModificar(){var a=confirm("Está seguro que desea modificar el registro seleccionado?");return 1==a?(ValidarDatosAjustados(2),!0):!1}function ConfirmarEliminar(){var a=confirm("Está seguro que desea eliminar el registro seleccionado?");return 1==a?($cuentaMensajes=1,AsignarCambioManual(!1),ManipularRegistro(3),!0):!1}function ManipularRegistro(a){$$("lblMensaje").text("");var e="";if(--$cuentaMensajes,3!=a&&$CambioManual?ValidarSumatoriPorcentajes():$SumatoriaValida=!0,AsignarSumatoriaValida($CambioManual?$SumatoriaValida:!0),$SumatoriaValida){if($SumatoriaValida&&0===$cuentaMensajes){var o="frmMantenimientoSaldosTotalesPorcentajeResponsabilidad.aspx",i="",t=$$("txtSaldoAjustado").val(),r=$$("txtPorcentajeResponsabilidad").val(),n="",l=$arregloOperaciones.length>0?ConvertirArregloOperacionesJson():"",d="undefined"!=typeof $CambioManual&&$CambioManual?"1":"0",s="";if(null!=$registroSeleccionado){switch(a){case 1:n="Insertando",i=o+"/InsertarRegistro",e="La información se incluyó satisfactoriamente.",s="{'consecutivoOperacion':'"+$registroSeleccionado.ConsecutivoOperacion+"', 'consecutivoGarantia':'"+$registroSeleccionado.ConsecutivoGarantia+"', 'tipoGarantia':'"+$registroSeleccionado.CodigoTipoGarantia+"', 'saldoActualAjustado':'"+t+"', 'porcentajeRespAjustado':'"+r+"', 'arregloElementos':'"+l+"', 'cambioManual':'"+d+"'}";break;case 2:n="Modificando",i=o+"/ModificarRegistro",e="La información se modificó satisfactoriamente.",$CambioManual?(i=o+"/ModificarRegistroManual",s="{'arregloElementos':'"+l+"'}"):(d="0",s="{'consecutivoOperacion':'"+$registroSeleccionado.ConsecutivoOperacion+"', 'consecutivoGarantia':'"+$registroSeleccionado.ConsecutivoGarantia+"', 'tipoGarantia':'"+$registroSeleccionado.CodigoTipoGarantia+"', 'saldoActualAjustado':'"+t+"', 'porcentajeRespAjustado':'"+r+"', 'arregloElementos':'"+l+"', 'cambioManual':'"+d+"'}");break;case 3:n="Eliminando",i=o+"/EliminarRegistro",e="La información se eliminó satisfactoriamente.",s="{'consecutivoOperacion':'"+$registroSeleccionado.ConsecutivoOperacion+"', 'consecutivoGarantia':'"+$registroSeleccionado.ConsecutivoGarantia+"', 'tipoGarantia':'"+$registroSeleccionado.CodigoTipoGarantia+"', 'saldoActualAjustado':'"+t+"', 'porcentajeRespAjustado':'"+r+"', 'arregloElementos':'"+l+"', 'cambioManual':'"+d+"'}"}$.blockUI({message:null,onBlock:function(){$.ajax({type:"POST",async:!1,url:i,data:s,contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){if($CambioManual=!1,a.length>0)if(0===a[0].CodigoError){$arregloOperaciones=a;var o='<input type="checkbox" checked="checked" disabled="disabled"/>',i='<input type="checkbox"disabled="disabled"/>',t=$("[id*=gdvOperaciones] tr:last-child").clone(!0);$("[id*=gdvOperaciones] tr").not($("[id*=gdvOperaciones] tr:first-child")).remove();for(var r=0;r<a.length;r++)1===a[r].NumeroRegistro&&($("td",t).eq(0).html('<a style="color: #333333" href="javascript:DesplegarAjustes(\''+a[r].ConsecutivoOperacion+"', '"+a[r].ConsecutivoGarantia+"');\" onclick=\"javascript:DesplegarAjustes('"+a[r].ConsecutivoOperacion+"', '"+a[r].ConsecutivoGarantia+"');\">"+a[r].OperacionLarga+"</a>"),$("td",t).eq(1).html(a[r].SaldoActualTexto),$("td",t).eq(2).html(a[r].PorcentajeResponsabilidadTexto),$("td",t).eq(3).html(2!==a[r].CodigoTipoOperacion?a[r].CuentaContable:"-"),$("td",t).eq(4).html(a[r].TipoOperacion),$("td",t).eq(5).html(a[r].IndicadorExcluido?o:i),$("td",t).eq(6).html(a[r].ConsecutivoOperacion),$("td",t).eq(7).html(a[r].ConsecutivoGarantia),$("td",t).eq(8).html(a[r].CodigoTipoGarantia),$("td",t).eq(9).html(a[r].IndicadorExcluido),$("[id*=gdvOperaciones]").append(t),t=$("[id*=gdvOperaciones] tr:last-child").clone(!0));DesplegarAjustes($registroSeleccionado.ConsecutivoOperacion,$registroSeleccionado.ConsecutivoGarantia),$$("lblMensaje").text(e)}else $$("lblMensaje").text(a[0].DescripcionError)},failure:function(a){$$("lblMensaje").text(a)}})}})}}}else{var c=$('<div class="ui-widget" style="padding-top:2.2em;"><div class="ui-state-error ui-corner-all" style="padding: 0 .7em;"><p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span>La sumatoria de los porcentajes de responsabilidad de todos los registros enlistados supera el 100%. Favor verificar.</p></div></div>').dialog({autoOpen:!1,title:"Sumatoria Porcentaje Responsabilidad Inválida",resizable:!1,draggable:!1,height:235,width:650,closeOnEscape:!1,open:function(a,e){$(".ui-dialog-titlebar-close").hide(),$(this).dialog("widget").position({my:"center bottom",at:"center bottom",of:window,collision:"none"}),++$cuentaMensajes},modal:!0,buttons:{Aceptar:function(){$(this).dialog("close")}}});c.dialog("open")}}function ValidarPorcentajeResponsabilidad(){var a=$$("txtPorcentajeResponsabilidad").val().length>0?$$("txtPorcentajeResponsabilidad").val():"0",e=parseFloat(a);100==e&&$MensajePorcentajeMaximo.dialog("open")}function ActualizaValoresAjustados(){if(null!=$registroSeleccionado){var a=($$("txtSaldoAjustado").val().length>0?$$("txtSaldoAjustado").val():"0").replace(/[^0-9-.]/g,""),e=parseFloat(a),o=$$("txtPorcentajeResponsabilidad").val().length>0?$$("txtPorcentajeResponsabilidad").val():"0";parseFloat(o);if($registroSeleccionado.SaldoActualAjustado=e,$registroSeleccionado.PorcentajeResponsabilidadAjustado=o,$arregloOperaciones.length>0)for(var i=0;i<$arregloOperaciones.length;i++)$registroSeleccionado.ConsecutivoOperacion==$arregloOperaciones[i].ConsecutivoOperacion&&$registroSeleccionado.ConsecutivoGarantia==$arregloOperaciones[i].ConsecutivoGarantia&&$registroSeleccionado.CodigoTipoGarantia==$arregloOperaciones[i].CodigoTipoGarantia&&($arregloOperaciones[i].IndicadorAjusteCampoSaldo=$arregloOperaciones[i].SaldoActualAjustado!=$registroSeleccionado.SaldoActualAjustado?!0:!1,
$arregloOperaciones[i].IndicadorAjusteCampoPorcentaje=$arregloOperaciones[i].PorcentajeResponsabilidadAjustado!=$registroSeleccionado.PorcentajeResponsabilidadAjustado?!0:!1,$arregloOperaciones[i].SaldoActualAjustado=$registroSeleccionado.SaldoActualAjustado,$arregloOperaciones[i].PorcentajeResponsabilidadAjustado=$registroSeleccionado.PorcentajeResponsabilidadAjustado,$arregloOperaciones[i].SaldoActualTexto=accounting.formatMoney($registroSeleccionado.SaldoActualAjustado,{symbol:"",thousand:",",decimal:"."}),$arregloOperaciones[i].PorcentajeResponsabilidadTexto=accounting.formatMoney($registroSeleccionado.PorcentajeResponsabilidadAjustado,{symbol:"",thousand:",",decimal:"."}))}}function ValidarSumatoriPorcentajes(){if($arregloOperaciones.length>0){for(var a=0,e=0;e<$arregloOperaciones.length;e++)1===$arregloOperaciones[e].NumeroRegistro&&(a+=parseFloat($arregloOperaciones[e].PorcentajeResponsabilidadAjustado>0?$arregloOperaciones[e].PorcentajeResponsabilidadAjustado:$arregloOperaciones[e].PorcentajeResponsabilidadCalculado));a=accounting.toFixed(a,2),AsignarSumatoriaValida(a>100?!1:!0)}}function ValidarDatosAjustados(a){if(AsignarCambioManual(!1),AsignarSumatoriaValida(!0),null!=$registroSeleccionado){this.SaldoActualAjustado=o,this.SaldoActual;var e=($$("txtSaldoAjustado").val().length>0?$$("txtSaldoAjustado").val():"0").replace(/[^0-9-.]/g,""),o=parseFloat(e),i=parseFloat($registroSeleccionado.SaldoMostrado),t=parseFloat(o>i?o-i:i-o).toFixed(2).toString("N2"),r=$$("txtPorcentajeResponsabilidad").val().length>0?$$("txtPorcentajeResponsabilidad").val():"0",n=parseFloat(r),l=parseFloat($registroSeleccionado.PorcentajeResponsabilidadAjustado),d=parseFloat(100-n);if($cuentaMensajes=0,$porcentajeCien=!1,$CambioManual&&ActualizaValoresAjustados(),$arregloOperaciones.length>0){for(var s=0,c=0;c<$arregloOperaciones.length;c++)1===$arregloOperaciones[c].NumeroRegistro&&(s+=$registroSeleccionado.ConsecutivoOperacion==$arregloOperaciones[c].ConsecutivoOperacion&&$registroSeleccionado.ConsecutivoGarantia==$arregloOperaciones[c].ConsecutivoGarantia&&$registroSeleccionado.CodigoTipoGarantia==$arregloOperaciones[c].CodigoTipoGarantia?n:parseFloat($arregloOperaciones[c].PorcentajeResponsabilidadAjustado>0?$arregloOperaciones[c].PorcentajeResponsabilidadAjustado:$arregloOperaciones[c].PorcentajeResponsabilidadCalculado));s>100&&AsignarSumatoriaValida(!1)}if(o>$registroSeleccionado.SaldoActual){var u=$('<div class="ui-widget" style="padding-top:2.2em;"><div class="ui-state-error ui-corner-all" style="padding: 0 .7em;"><p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span>El valor ajustado a aumentado en '+formatFloat(t,2,".",",")+", está seguro que desea modificar el valor, esto afectará la distribución de mitigadores.</p></div></div>").dialog({autoOpen:!1,title:"Saldo Ajustado Mayor",resizable:!1,draggable:!1,height:235,width:650,closeOnEscape:!1,open:function(a,e){$(".ui-dialog-titlebar-close").hide(),$(this).dialog("widget").position({my:"center bottom",at:"center bottom",of:window,collision:"none"}),++$cuentaMensajes},modal:!0,buttons:{Aceptar:function(){$(this).dialog("close")}},close:function(){ManipularRegistro(a)}});u.dialog("open")}else if(o<$registroSeleccionado.SaldoActual){var p=$('<div class="ui-widget" style="padding-top:2.2em;"><div class="ui-state-error ui-corner-all" style="padding: 0 .7em;"><p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em;"></span>El valor ajustado disminuyó en '+formatFloat(t,2,".",",")+", está seguro que desea modificar el valor, esto afectará la distribución de mitigadores.</p></div></div>").dialog({autoOpen:!1,title:"Saldo Ajustado Menor",resizable:!1,draggable:!1,height:235,width:650,closeOnEscape:!1,open:function(a,e){$(".ui-dialog-titlebar-close").hide(),$(this).dialog("widget").position({my:"center bottom",at:"center bottom",of:window,collision:"none"}),++$cuentaMensajes},modal:!0,buttons:{Aceptar:function(){$(this).dialog("close")}},close:function(){ManipularRegistro(a)}});p.dialog("open")}if(100==n)$porcentajeCien=!0,++$cuentaMensajes,ManipularRegistro(a);else if(l>n)++$cuentaMensajes,ManipularRegistro(a);else if(n>l){var u=$('<div class="ui-widget" style="padding-top:2.2em;"><div class="ui-state-error ui-corner-all" style="padding: 0 .7em;"><p><span class="ui-icon ui-icon-alert" style="float: left; margin-right: .3em; margin-bottom: 1.8em;"></span>Usted ha modificado el % de responsabilidad de una operación, si desea que el sistema respete este porcentaje y haga una nueva distribución con el porcentaje faltante de  '+formatFloat(d,2,".",",")+" presione “Aceptar”, si no presione “Cambio Manual” para realizarlo usted.</p></div></div>").dialog({autoOpen:!1,title:"Porcentaje Responsabilidad Ajustado Mayor",resizable:!1,draggable:!1,height:235,width:650,closeOnEscape:!1,open:function(a,e){$(".ui-dialog-titlebar-close").hide(),$(this).dialog("widget").position({my:"center bottom",at:"center bottom",of:window,collision:"none"}),++$cuentaMensajes},modal:!0,buttons:{Aceptar:function(){$(this).dialog("close"),AsignarCambioManual(!1),ManipularRegistro(a)},"Cambio Manual":function(){$(this).dialog("close"),AsignarCambioManual(!0)}}});u.dialog("open")}else++$cuentaMensajes,ManipularRegistro(a)}}function AsignarCambioManual(a){$CambioManual="undefined"!=typeof $CambioManual&&$CambioManual?$CambioManual:a}function AsignarSumatoriaValida(a){$SumatoriaValida=a}function ValidarPermisoEdicion(){var a="frmMantenimientoSaldosTotalesPorcentajeResponsabilidad.aspx",e=null!=$$("hdnPerfilesPermitidos").val()?$$("hdnPerfilesPermitidos").val():"";$$("lblMensaje").text(""),$.ajax({type:"POST",async:!1,url:a+"/ValidarPermisoEdicionUsuario",data:"{'perfilesPermitodos':'"+e+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){$$("lblMensaje").text(""),null!=a&&a.length>1?$PermisoEdicion=a:$PermisoEdicion="0",$$("hdnPermisoEdicion").val(a)},failure:function(a){$$("lblMensaje").text(a)}})}function CargarListaCatalogo(a,e,o,i){var t="frmMantenimientoSaldosTotalesPorcentajeResponsabilidad.aspx";$$("lblMensaje").text(""),$.ajax({type:"POST",async:!1,url:t+"/ExtraerCatalogo",data:"{'codigoCatologo':'"+a+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){if($$("lblMensaje").text(""),null!=a&&a.length>1){var t="",r=parseInt(o),n=parseInt(i);if(-1===r)$($.parseJSON(a)).map(function(){t+="<option value='"+this.cat_elemento+"'>"+this.cat_descripcion+"</option>"});else if(1===r)$($.parseJSON(a)).map(function(){t+="<option value='"+this.cat_elemento+"'>"+this.cat_descripcion+"</option>"});else if(2===r)switch(n){case 1:$($.parseJSON(a)).map(function(){var a=parseInt(this.cat_elemento);a>=10&&17>=a&&(t+="<option value='"+this.cat_elemento+"'>"+this.cat_descripcion+"</option>")});break;case 2:$($.parseJSON(a)).map(function(){var a=parseInt(this.cat_elemento);(18==a||a>=20&&29>=a)&&(t+="<option value='"+this.cat_elemento+"'>"+this.cat_descripcion+"</option>")});break;case 3:$($.parseJSON(a)).map(function(){var a=parseInt(this.cat_elemento);a>=30&&69>=a&&(t+="<option value='"+this.cat_elemento+"'>"+this.cat_descripcion+"</option>")})}else 3===r&&$($.parseJSON(a)).map(function(){var a=parseInt(this.cat_elemento);a>=20&&29>=a&&(t+="<option value='"+this.cat_elemento+"'>"+this.cat_descripcion+"</option>")});e.html(t)}else $$("lblMensaje").text(a)},failure:function(a){$$("lblMensaje").text(a)}})}function ValidarOperacion(){if($$("lblMensaje").text(""),ValidarCamposOpercion()){var a="frmMantenimientoSaldosTotalesPorcentajeResponsabilidad.aspx",e=parseInt(null!=$$("cbTipoBusqueda").val()?$$("cbTipoBusqueda").val():"-1"),o=$$("txtContabilidad").val(),i=$$("txtOficina").val(),t=$$("txtMoneda").val(),r=1===e?$$("txtProducto").val():"-1",n=$$("txtOperacion").val(),l="",d=!1;$$("accordionGF").hide(),$$("accordionGR").hide(),$$("accordionGV").hide(),$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide(),$.blockUI({message:null,onBlock:function(){$.ajax({type:"POST",async:!1,url:a+"/ValidarOperacion",data:"{'codigoContabilidad':'"+o+"', 'codigoOficina':'"+i+"', 'codigoMoneda':'"+t+"', 'codigoProducto':'"+r+"', 'numeroOperacion':'"+n+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(s){if(s.length>1){$$("gdvOperaciones").hide();var c=s.split("|");if(null!=c&&null!=c[0]&&c[0].length>0&&"0"!=c[0]&&c[1].length>0)return $$("lblMensaje").text(c[1]),$$("accordionGF").hide(),$$("accordionGR").hide(),$$("accordionGV").hide(),$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide(),!1;if(null!=c&&null!=c[0]&&c[0].length>0&&"0"==c[0]){$$("accordionGF").show(),$$("accordionGR").show(),$$("accordionGV").show(),l=c[1].length>0?c[1]:"",d=!0;for(var u=1;3>=u;u++)$.ajax({type:"POST",async:!1,url:a+"/ObtenerGarantias",data:"{'tipoOperacion':'"+e.toString()+"', 'consecutivoOperacion':'"+l+"', 'codigoContabilidad':'"+o+"', 'codigoOficina':'"+i+"', 'codigoMoneda':'"+t+"', 'codigoProducto':'"+r+"', 'numeroOperacion':'"+n+"', 'tipoGarantia':'"+u.toString()+"'}",contentType:"application/json; charset=utf-8",dataType:"text html",success:function(a){if(a.length>0)switch(u){case 1:$datosConsulta=htmlDecode(a).replace('"<table>',"<table>").replace('</table>"',"</table>"),$$("tablaGarantiasFiduciarias").empty().append($datosConsulta),$$("accordionGF").accordion("refresh");break;case 2:$datosConsulta=htmlDecode(a).replace('"<table>',"<table>").replace('</table>"',"</table>"),$$("tablaGarantiasReales").empty().append($datosConsulta),$$("accordionGR").accordion("refresh");break;case 3:$datosConsulta=htmlDecode(a).replace('"<table>',"<table>").replace('</table>"',"</table>"),$$("tablaGarantiasValor").empty().append($datosConsulta),$$("accordionGV").accordion("refresh")}},failure:function(a){$$("lblMensaje").text(a)}})}}},failure:function(a){$$("lblMensaje").text(a)}})}})}}function ValidarGarantia(){$$("lblMensaje").text(""),$$("accordionGF").hide(),$$("accordionGR").hide(),$$("accordionGV").hide(),$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide();var a=parseInt(null!=$$("cbTipoGarantia").val()?$$("cbTipoGarantia").val():"-1");if(ValidarCamposGarantia())switch(a){case 1:var e=$$("cbTipoPersona").val(),o=$$("txtCedulaFiador").val();ConsultarGarantiaFiduciaria(e,o);break;case 2:var i=$$("txtNumFinca").val(),t=$$("cbClaseGarantiaReal").val(),r=$$("txtPartido").val().length>0?$$("txtPartido").val():"-1",n=$$("txtGrado").val().length>0?$$("txtGrado").val():"-1";ConsultarGarantiaReal(i,t,r,n);break;case 3:var l=$$("txtNumeroSeguridad").val(),t=$$("cbClaseGarantiaValor").val();ConsultarGarantiaValor(l,t);break;default:SaldosTotalesPorcResp_PageInit()}}function ConsultarGarantiaFiduciaria(a,e){$$("lblMensaje").text("");var o="frmMantenimientoSaldosTotalesPorcentajeResponsabilidad.aspx";$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide(),null!=e&&$.blockUI({message:null,onBlock:function(){$.ajax({type:"POST",async:!1,url:o+"/ObtenerOperacionesGarantiaFiduciaria",data:"{'tipoPersona':'"+a+"', 'identificacionFiador':'"+e+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){if(a.length>0)if(0===a[0].CodigoError){$arregloOperaciones=a;var e='<input type="checkbox" checked="checked" disabled="disabled"/>',o='<input type="checkbox"disabled="disabled"/>',i=$("[id*=gdvOperaciones] tr:last-child").clone(!0);$("[id*=gdvOperaciones] tr").not($("[id*=gdvOperaciones] tr:first-child")).remove();for(var t=0;t<a.length;t++)1===a[t].NumeroRegistro&&($("td",i).eq(0).html('<a style="color: #333333" href="javascript:DesplegarAjustes(\''+a[t].ConsecutivoOperacion+"', '"+a[t].ConsecutivoGarantia+"');\" onclick=\"javascript:DesplegarAjustes('"+a[t].ConsecutivoOperacion+"', '"+a[t].ConsecutivoGarantia+"');\">"+a[t].OperacionLarga+"</a>"),$("td",i).eq(1).html(a[t].SaldoActualTexto),$("td",i).eq(2).html(a[t].PorcentajeResponsabilidadTexto),$("td",i).eq(3).html(2!==a[t].CodigoTipoOperacion?a[t].CuentaContable:"-"),$("td",i).eq(4).html(a[t].TipoOperacion),$("td",i).eq(5).html(a[t].IndicadorExcluido?e:o),$("td",i).eq(6).html(a[t].ConsecutivoOperacion),$("td",i).eq(7).html(a[t].ConsecutivoGarantia),$("td",i).eq(8).html(a[t].CodigoTipoGarantia),$("td",i).eq(9).html(a[t].IndicadorExcluido),$("[id*=gdvOperaciones]").append(i),i=$("[id*=gdvOperaciones] tr:last-child").clone(!0));$$("gdvOperaciones").show()}else $$("lblMensaje").text(a[0].DescripcionError),$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide()},failure:function(a){$$("lblMensaje").text(a),$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide()}})}})}function ConsultarGarantiaReal(a,e,o,i){$$("lblMensaje").text("");var t="frmMantenimientoSaldosTotalesPorcentajeResponsabilidad.aspx";$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide(),null!=a&&null!=e&&$.blockUI({message:null,onBlock:function(){$.ajax({type:"POST",async:!1,url:t+"/ObtenerOperacionesGarantiaReal",data:"{'identificacionBien':'"+a+"', 'claseGarantia':'"+e+"', 'codigoPartido':'"+o+"', 'codigoGrado':'"+i+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){if(a.length>0)if(0===a[0].CodigoError){$arregloOperaciones=a;var e='<input type="checkbox" checked="checked" disabled="disabled"/>',o='<input type="checkbox"disabled="disabled"/>',i=$("[id*=gdvOperaciones] tr:last-child").clone(!0);$("[id*=gdvOperaciones] tr").not($("[id*=gdvOperaciones] tr:first-child")).remove();for(var t=0;t<a.length;t++)1===a[t].NumeroRegistro&&($("td",i).eq(0).html('<a style="color: #333333" href="javascript:DesplegarAjustes(\''+a[t].ConsecutivoOperacion+"', '"+a[t].ConsecutivoGarantia+"');\" onclick=\"javascript:DesplegarAjustes('"+a[t].ConsecutivoOperacion+"', '"+a[t].ConsecutivoGarantia+"');\">"+a[t].OperacionLarga+"</a>"),$("td",i).eq(1).html(a[t].SaldoActualTexto),$("td",i).eq(2).html(a[t].PorcentajeResponsabilidadTexto),$("td",i).eq(3).html(2!==a[t].CodigoTipoOperacion?a[t].CuentaContable:"-"),$("td",i).eq(4).html(a[t].TipoOperacion),$("td",i).eq(5).html(a[t].IndicadorExcluido?e:o),$("td",i).eq(6).html(a[t].ConsecutivoOperacion),$("td",i).eq(7).html(a[t].ConsecutivoGarantia),$("td",i).eq(8).html(a[t].CodigoTipoGarantia),$("td",i).eq(9).html(a[t].IndicadorExcluido),$("[id*=gdvOperaciones]").append(i),i=$("[id*=gdvOperaciones] tr:last-child").clone(!0));$$("gdvOperaciones").show()}else $$("lblMensaje").text(a[0].DescripcionError),$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide()},failure:function(a){$$("lblMensaje").text(a),$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide()}})}})}function ConsultarGarantiaValor(a,e){$$("lblMensaje").text("");var o="frmMantenimientoSaldosTotalesPorcentajeResponsabilidad.aspx";$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide(),null!=a&&null!=e&&$.blockUI({message:null,onBlock:function(){$.ajax({type:"POST",async:!1,url:o+"/ObtenerOperacionesGarantiaValor",data:"{'numeroSeguridad':'"+a+"', 'claseGarantia':'"+e+"'}",contentType:"application/json; charset=utf-8",dataType:"json",success:function(a){if(a.length>0)if(0===a[0].CodigoError){$arregloOperaciones=a;var e='<input type="checkbox" checked="checked" disabled="disabled"/>',o='<input type="checkbox"disabled="disabled"/>',i=$("[id*=gdvOperaciones] tr:last-child").clone(!0);$("[id*=gdvOperaciones] tr").not($("[id*=gdvOperaciones] tr:first-child")).remove();for(var t=0;t<a.length;t++)1===a[t].NumeroRegistro&&($("td",i).eq(0).html('<a style="color: #333333" href="javascript:DesplegarAjustes(\''+a[t].ConsecutivoOperacion+"', '"+a[t].ConsecutivoGarantia+"');\" onclick=\"javascript:DesplegarAjustes('"+a[t].ConsecutivoOperacion+"', '"+a[t].ConsecutivoGarantia+"');\">"+a[t].OperacionLarga+"</a>"),$("td",i).eq(1).html(a[t].SaldoActualTexto),$("td",i).eq(2).html(a[t].PorcentajeResponsabilidadTexto),$("td",i).eq(3).html(2!==a[t].CodigoTipoOperacion?a[t].CuentaContable:"-"),$("td",i).eq(4).html(a[t].TipoOperacion),$("td",i).eq(5).html(a[t].IndicadorExcluido?e:o),$("td",i).eq(6).html(a[t].ConsecutivoOperacion),$("td",i).eq(7).html(a[t].ConsecutivoGarantia),$("td",i).eq(8).html(a[t].CodigoTipoGarantia),$("td",i).eq(9).html(a[t].IndicadorExcluido),$("[id*=gdvOperaciones]").append(i),i=$("[id*=gdvOperaciones] tr:last-child").clone(!0));$$("gdvOperaciones").show()}else $$("lblMensaje").text(a[0].DescripcionError),$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide()},failure:function(a){$$("lblMensaje").text(a),$$("filaDetalleAjuste").hide(),$$("gdvOperaciones").hide()}})}})}function RegistroSeleccionado(a,e,o,i,t,r,n,l){this.ConsecutivoOperacion=a,this.ConsecutivoGarantia=e,this.CodigoTipoGarantia=o,this.SaldoActualAjustado=i,this.SaldoActual=t,this.PorcentajeResponsabilidadAjustado=r,this.IndiceRegistro=n,this.SaldoMostrado=l}